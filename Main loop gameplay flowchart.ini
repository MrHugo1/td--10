Main loop gameplay flowchart
┌──────────────┐
│ 1. Plant     │
│ (Chọn ô đất) │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 2. Growing   │
│ (Timer đếm)  │
└──────┬───────┘
       │ Timer xong
       ▼
┌──────────────┐
│ 3. Harvest   │
│ (Thu hoạch)  │
└──────┬───────┘
       │ + Silo (wheat)
       ▼
┌────────────────────────┐
│ 4. Silo/Throughput     │
│ (Kiểm tra meter load)  │
└──────┬─────────┬───────┘
       │         │
       │         └──────────┐
       ▼                    │
┌──────────────┐            │
│ 5. Mill      │            │
│ (Tự động     │◄──────────┘
│   lấy wheat) │
└──────┬───────┘
       │ + Flour vào silo
       ▼
┌──────────────┐
│ 6. Bakery    │
│ (Tự động     │
│   lấy flour) │
└──────┬───────┘
       │ + Bread vào silo
       ▼
┌──────────────┐
│ 7. Contract  │
│ (Đủ Bread    │
│   -> Deliver │
│   -> Reward) │
└──────┬───────┘
       │ + Coins, Pipe Part
       ▼
┌──────────────┐
│ 8. Upgrade   │
│ (Dùng Pipe   │
│   Part tăng  │
│   bandwidth) │
└──────┬───────┘
       │
       └──> Quay lại 1 (Plant lại/tiếp tục)

Sơ đồ module/class tổ chức
┌───────────────────────┐
│      GameController   │
│────────────────────── │
│ - tick()              │
│ - handleHarvest()     │
│ - handleContract()    │
│ - handleUpgrade()     │
└─────────┬─────────────┘
          │
 ┌────────┼───────────┐
 │        │           │
 ▼        ▼           ▼
MapMgr  SiloMgr   MachineMgr
(Plant/  (addTo/   (autoFeed/
Harvest) takeFrom) process)
         │           │
         ▼           ▼
      [Throughput]  [Recipe]
         │           │
      UIManager (Hiển thị panel/hud/popup)

Mối liên hệ dữ liệu (Data Flow)
[Player]
   |
   |      (coins, inventory, pipe_part)
   ▼
[Map] <--- [GameController] ---> [Silo] <--- [Machine]
   |           |                     |
[Field]   [ContractMgr]          [Throughput Meter]

Interaction sơ lược (UI Flow):
    FarmScene: click ô đất → Plant, sau timer click lại để Harvest.

    SiloPanel: xem throughput, nâng cấp bandwidth.

    MachinePanel: theo dõi tiến trình Mill/Bakery.

    ContractBoard: kiểm tra bread, bấm giao đơn nhận thưởng.

    UpgradePopup: khi đủ pipe_part, bấm nâng cấp.

Hình minh họa (pseudo-sketch)
───────────── FIELDS (3x3) ─────────────
[W] [ ] [C]
[ ] [W] [ ]
[C] [ ] [ ]

──────── SILO PANEL ────────
| Wheat Silo | [100/100] ⚡️  (meter màu)
| Flour Silo | [50/60]  ⚡️
───────────────

───── MACHINE PANEL ─────
| Mill: 2wheat → 1flour | [timer]
| Bakery: 2flour → 1bread | [timer]
─────────────────────────

───── CONTRACT BOARD ─────
| 20 Bread ➜ Deliver |
─────────────────────

───── UPGRADE POPUP ──────
| +40 Bandwidth (3 pipe_part + coins) |
─────────────────────────

| Phase  | Nội dung                                                                                         | Kết quả kỳ vọng                                                          |
| ------ | ------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------ |
| **P1** | **Vòng lặp cốt lõi:** Map, ô trồng, thu hoạch, Silo, cơ bản Machine (Mill), giao diện throughput | Trồng-lấy lúa-thả vào silo, máy xay bột, UI meter, có thể “tắc” nếu spam |
| **P2** | Bakery (dây chuyền flour→bread), Contract Board, Claim reward                                    | Chuỗi Wheat → Flour → Bread → Giao đơn, nhận thưởng                      |
| **P3** | Nâng cấp Silo, Pipe Part & popup, Debuff khi tắc silo                                            | Người chơi nâng throughput để tối ưu sản xuất, cảm nhận “thông ống”      |
| **P4** | Cân chỉnh timer & balancing, debug HUD, polish UI                                                | Playtest, tune số liệu, UI thân thiện                                    |
| **P5** | Stretch: thêm Corn/Popcorn, social stub (Boost), save/load                                       | Mở rộng thêm gameplay, chuẩn bị test nội bộ                              |
